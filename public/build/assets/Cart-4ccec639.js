import{v as B,_ as M,o as a,c as V,w as n,d as y,e as l,p as f,t as m,a as u,r,u as w,q as A,k as D,B as I,x as S,g as P,y as O,F as h,b as k}from"./app-aa966424.js";import{P as U}from"./ProductCard-deb62e2e.js";import{p as E}from"./price-38bf80ae.js";import{V as R}from"./ViewTitle-c1beea11.js";import{A as T}from"./orders-d4e159fb.js";import{S as q}from"./StyledRouterLink-4f78989f.js";import{g as F}from"./name-4e882a16.js";import"./ProductPrice-d0fb473b.js";import"./ProductOpenLink-f21a3374.js";import"./ItemImage-884cebd2.js";const L={name:"SubmitCartMessage",components:{StyledRouterLink:q},emits:["update:isVisible","submitCart"],data(){return{userName:null,userAddress:null,userMobile:null}},props:{isVisible:{required:!0,type:Boolean},pending:{required:!0,type:Boolean}},computed:{...B("auth",["user"]),isDialogVisible:{get(){return this.isVisible},set(e){this.$emit("update:isVisible",e)}},userNames(){return this.user.names},userNameOptions(){return this.userNames.map(e=>({value:e.id,label:F(e.firstName,e.middleName,e.lastName)}))},userMobiles(){return this.user.mobiles},userMobileOptions(){return this.userMobiles.map(e=>({value:e.id,label:e.mobile}))},userAddresses(){return this.user.addresses},userAddressOptions(){return this.userAddresses.map(e=>({value:e.id,label:e.address}))}}},G={key:1},W={class:"dialog-footer"};function j(e,t,p,N,s,i){const c=r("el-select-v2"),_=r("el-form-item"),b=r("el-form"),v=r("styled-router-link"),g=r("el-button"),C=r("el-dialog");return a(),V(C,{modelValue:i.isDialogVisible,"onUpdate:modelValue":t[5]||(t[5]=o=>i.isDialogVisible=o),title:e.$t("cart.cart"),width:"90%"},{footer:n(()=>[y("span",W,[l(g,{onClick:t[3]||(t[3]=o=>i.isDialogVisible=!1)},{default:n(()=>[f(m(e.$t("general.cancel")),1)]),_:1}),l(g,{type:"primary",loading:p.pending,disabled:p.pending||!(s.userName&&s.userAddress&&s.userMobile),onClick:t[4]||(t[4]=o=>e.$emit("submitCart",{userNameId:s.userName,userAddressId:s.userAddress,userMobileId:s.userMobile}))},{default:n(()=>[f(m(e.$t("general.save")),1)]),_:1},8,["loading","disabled"])])]),default:n(()=>[y("div",null,m(e.$t("cart.buyMessage.info")),1),i.userNames.length>0&&i.userAddresses.length>0&&i.userMobiles.length>0?(a(),V(b,{key:0,"label-position":"top"},{default:n(()=>[l(_,{label:e.$t("profile.titles.names")},{default:n(()=>[l(c,{modelValue:s.userName,"onUpdate:modelValue":t[0]||(t[0]=o=>s.userName=o),options:i.userNameOptions,class:"user-data-select"},null,8,["modelValue","options"])]),_:1},8,["label"]),l(_,{label:e.$t("profile.titles.mobiles")},{default:n(()=>[l(c,{modelValue:s.userMobile,"onUpdate:modelValue":t[1]||(t[1]=o=>s.userMobile=o),options:i.userMobileOptions,class:"user-data-select"},null,8,["modelValue","options"])]),_:1},8,["label"]),l(_,{label:e.$t("profile.titles.addresses")},{default:n(()=>[l(c,{modelValue:s.userAddress,"onUpdate:modelValue":t[2]||(t[2]=o=>s.userAddress=o),options:i.userAddressOptions,class:"user-data-select"},null,8,["modelValue","options"])]),_:1},8,["label"])]),_:1})):(a(),u("div",G,[l(v,{class:"open-profile-link",to:{name:"Profile"}},{default:n(()=>[f(m(this.$t("cart.buyMessage.emptyUserData")),1)]),_:1})]))]),_:1},8,["modelValue","title"])}const z=M(L,[["render",j],["__scopeId","data-v-d44218f5"]]);const H={name:"Cart",mixins:[E,w,A],components:{SubmitCartMessage:z,ViewTitle:R,FullWidthButton:D,BasedText:I,ProductCard:U},data(){return{pending:!0,isBuyCartDialogVisible:!1}},methods:{...S("cart",["loadCart"]),onBuyButtonClick(){this.isBuyCartDialogVisible=!0},async onCartSubmit({userNameId:e,userMobileId:t,userAddressId:p}){await this.useErrorsCatch(async()=>{this.isBuyCartDialogVisible=!1,await P(T,{},{userNameId:e,userMobileId:t,userAddressId:p}),await this.loadCart(),await this.$router.push({name:"Orders"})})}},computed:{...B("cart",["cartItems"]),...O("cart",["getTotalPrice"]),products(){return this.cartItems.map(e=>e.product)}},async mounted(){await this.loadCart(),this.pending=!1}},J={class:"cart-container"},K={key:0},Q={key:0},X={key:1},Y={key:1};function Z(e,t,p,N,s,i){const c=r("view-title"),_=r("product-card"),b=r("el-divider"),v=r("based-text"),g=r("full-width-button"),C=r("submit-cart-message"),o=r("el-skeleton");return a(),u("div",null,[l(c,{text:e.$t("cart.cart")},null,8,["text"]),y("div",J,[!s.pending||e.cartItems.length>0?(a(),u("div",K,[e.cartItems.length>0?(a(),u("div",Q,[(a(!0),u(h,null,k(i.products,d=>(a(),u("div",{key:d.slug},[l(_,{product:d,class:"product-card","is-show-add-to-cart-button":!0},null,8,["product"]),l(b)]))),128)),l(v,{title:e.$t("general.total")+": "+e.getCurrency(e.getTotalPrice)},null,8,["title"]),l(g,{type:"success",onClick:i.onBuyButtonClick,pending:s.pending},{default:n(()=>[f(m(e.$t("general.buy")),1)]),_:1},8,["onClick","pending"]),l(C,{"is-visible":s.isBuyCartDialogVisible,"onUpdate:isVisible":t[0]||(t[0]=d=>s.isBuyCartDialogVisible=d),pending:s.pending,onSubmitCart:t[1]||(t[1]=d=>e.usePending(i.onCartSubmit,"pending",d))},null,8,["is-visible","pending"])])):(a(),u("div",X,m(e.$t("cart.noProducts")),1))])):(a(),u("div",Y,[(a(),u(h,null,k(10,d=>y("div",{key:d},[l(o,{animated:""}),l(b)])),64))]))])])}const ne=M(H,[["render",Z],["__scopeId","data-v-4134ea5a"]]);export{ne as default};
