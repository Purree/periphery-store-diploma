import{_ as g,B as h,r as u,o as m,c as b,w as i,q as I,t as U,e as r,a as y,d as D,f as q,F as T,v as F,V as $,k as E,g as x,m as A}from"./app-a341633d.js";import{P as B}from"./ProductDeleteButton-76990202.js";import{k}from"./products-7ae8b1be.js";import{I as C}from"./ItemImage-14603b6e.js";const R={name:"ProductUpdatePreviewForm",emits:["update:productPreviewImage","deletePreviousProductPreview"],components:{BasedText:h,ItemImage:C},props:{previousProductPreviewImageUrl:{required:!0,type:String},pending:{required:!0,type:Boolean},productPreviewImage:{required:!0}},computed:{previewImage:{get(){return this.productPreviewImage},set(e){this.$emit("update:productPreviewImage",e)}}}},j={key:0},O={class:"previous-product-preview-container"},N={class:"previous-product-preview"};function S(e,t,a,_,d,o){const l=u("font-awesome-icon"),p=u("el-popover"),n=u("el-upload"),s=u("based-text"),f=u("el-button"),P=u("item-image"),w=u("el-form-item");return m(),b(w,{prop:"previewImage",class:"form-item"},{label:i(()=>[I(U(e.$t("product.updateProduct.images.previewImage"))+" ",1),r(p,{placement:"top-start",title:e.$t("general.attention"),trigger:"hover",content:e.$tc("product.updateProduct.images.previewImageInfo",512)},{reference:i(()=>[r(l,{class:"preview-image-info-popover-icon",icon:"circle-info"})]),_:1},8,["title","content"])]),default:i(()=>[r(n,{class:"form-item-input",drag:!0,limit:1,"file-list":o.previewImage,"onUpdate:fileList":t[0]||(t[0]=v=>o.previewImage=v),"list-type":"picture",accept:"image/png, image/gif, image/jpeg","auto-upload":!1},null,8,["file-list"]),a.previousProductPreviewImageUrl?(m(),y("div",j,[r(s,{title:e.$t("product.updateProduct.images.currentImage")},null,8,["title"]),D("div",O,[r(f,{disabled:a.pending,loading:a.pending,type:"danger",plain:"",class:"delete-previous-product-preview-button",onClick:t[1]||(t[1]=v=>e.$emit("deletePreviousProductPreview"))},{default:i(()=>[r(l,{type:"danger",icon:"trash"},{default:i(()=>[I(U(e.$t("profile.avatar.buttons.delete")),1)]),_:1})]),_:1},8,["disabled","loading"]),D("div",N,[r(P,{"image-url":a.previousProductPreviewImageUrl},null,8,["image-url"])])])])):q("",!0)]),_:1})}const L=g(R,[["render",S],["__scopeId","data-v-e90ec75d"]]),z={name:"ProductUpdateTextDataInputs",emits:["update:product"],props:{product:{required:!0,type:Object}},computed:{productData:{get(){return this.product},set(e){this.$emit("update:product",e)}}}};function W(e,t,a,_,d,o){const l=u("el-input"),p=u("el-form-item");return m(),y(T,null,[r(p,{label:e.$t("product.updateProduct.title"),prop:"title",class:"form-item"},{default:i(()=>[r(l,{class:"form-item-input",modelValue:o.productData.title,"onUpdate:modelValue":t[0]||(t[0]=n=>o.productData.title=n)},null,8,["modelValue"])]),_:1},8,["label"]),r(p,{label:e.$t("product.updateProduct.metaTitle"),prop:"metaTitle",class:"form-item"},{default:i(()=>[r(l,{class:"form-item-input",modelValue:o.productData.metaTitle,"onUpdate:modelValue":t[1]||(t[1]=n=>o.productData.metaTitle=n)},null,8,["modelValue"])]),_:1},8,["label"]),r(p,{label:e.$t("product.updateProduct.description"),prop:"description",class:"form-item"},{default:i(()=>[r(l,{class:"form-item-input",modelValue:o.productData.description,"onUpdate:modelValue":t[2]||(t[2]=n=>o.productData.description=n),autosize:{minRows:3},type:"textarea"},null,8,["modelValue"])]),_:1},8,["label"])],64)}const M=g(z,[["render",W]]),G={name:"ProductUpdateComplexDataInputs",emits:["update:product"],props:{product:{required:!0,type:Object}},computed:{productData:{get(){return this.product},set(e){this.$emit("update:product",e)}}}};function H(e,t,a,_,d,o){const l=u("el-input-number"),p=u("el-form-item"),n=u("el-switch");return m(),y(T,null,[r(p,{label:e.$t("product.updateProduct.price"),prop:"price",class:"form-item"},{default:i(()=>[r(l,{class:"form-item-input",modelValue:o.productData.price,"onUpdate:modelValue":t[0]||(t[0]=s=>o.productData.price=s)},null,8,["modelValue"])]),_:1},8,["label"]),r(p,{label:e.$t("product.updateProduct.discount"),prop:"discount",class:"form-item"},{default:i(()=>[r(l,{min:0,max:100,class:"form-item-input",modelValue:o.productData.discount,"onUpdate:modelValue":t[1]||(t[1]=s=>o.productData.discount=s)},null,8,["modelValue"])]),_:1},8,["label"]),r(p,{label:e.$t("product.updateProduct.quantity"),prop:"quantity",class:"form-item"},{default:i(()=>[r(l,{class:"form-item-input",min:0,modelValue:o.productData.quantity,"onUpdate:modelValue":t[2]||(t[2]=s=>o.productData.quantity=s)},null,8,["modelValue"])]),_:1},8,["label"]),r(p,{label:e.$t("product.updateProduct.isAvailable"),prop:"isAvailable",class:"form-item"},{default:i(()=>[r(n,{class:"form-item-input","active-text":e.$t("product.updateProduct.available"),"inactive-text":e.$t("product.updateProduct.unavailable"),modelValue:o.productData.isAvailable,"onUpdate:modelValue":t[3]||(t[3]=s=>o.productData.isAvailable=s),size:"large"},null,8,["active-text","inactive-text","modelValue"])]),_:1},8,["label"])],64)}const J=g(G,[["render",H]]);const K={name:"ProductUpdateForm",computed:{generalPending(){return this.pending||this.previousProductPreviewImageDeletePending}},mixins:[F],components:{ProductUpdateComplexDataInputs:J,ProductUpdateTextDataInputs:M,ProductUpdatePreviewForm:L,ProductDeleteButton:B,ErrorsAlert:$,FullWidthButton:E},emits:["updateProduct","deleteProduct"],data(){return{product:{title:"",metaTitle:"",description:"",previewImage:[],price:-1,discount:0,quantity:0,isAvailable:!1},previousProductPreviewImageUrl:"",previousProductPreviewImageDeletePending:!1,validationRules:{title:{required:!0},metaTitle:{required:!0},description:{required:!0},price:{type:"number"},discount:{type:"number"},quantity:{type:"number"},isAvailable:{required:!0}},errors:{}}},props:{pending:{required:!1,type:Boolean,default:!1},requestErrors:{required:!1,type:Object,default:()=>{}},productToUpdate:{required:!1,type:Object,default:()=>{}}},methods:{async onSubmit(){this.errors={},await this.$refs.form.validate((e,t)=>{e?this.onFormValidation():this.errors={...this.errors,validation:[this.$t("profile.mainInformation.errors.validationMessage")]}})},async onPreviousProductPreviewDelete(){try{await x(k,{slug:this.productToUpdate.slug}),this.previousProductPreviewImageUrl=""}catch(e){this.errors=A(e)}},onFormValidation(){const e=Object.assign({},this.product);e.previewImage=e.previewImage.length===1?e.previewImage[0].raw:null,e.isAvailable=e.isAvailable?"1":"0";const t=new FormData;Object.keys(e).forEach(a=>{e[a]!==null&&t.append(a,e[a])}),this.$emit("updateProduct",t)}},watch:{productToUpdate(){const e=this.productToUpdate;this.previousProductPreviewImageUrl=e.previewImage,delete e.previewImage,this.product={...this.product,...e}}}},Q={class:"product-manipulate-buttons"};function X(e,t,a,_,d,o){const l=u("errors-alert"),p=u("product-update-text-data-inputs"),n=u("product-update-preview-form"),s=u("product-update-complex-data-inputs"),f=u("full-width-button"),P=u("product-delete-button"),w=u("el-form");return m(),b(w,{"label-position":"top",rules:d.validationRules,ref:"form",model:d.product},{default:i(()=>{var v,V;return[r(l,{errors:{...a.requestErrors,...d.errors}},null,8,["errors"]),r(p,{product:d.product,"onUpdate:product":t[0]||(t[0]=c=>d.product=c)},null,8,["product"]),r(n,{"product-preview-image":d.product.previewImage,"onUpdate:productPreviewImage":t[1]||(t[1]=c=>d.product.previewImage=c),onDeletePreviousProductPreview:t[2]||(t[2]=c=>e.usePending(o.onPreviousProductPreviewDelete,"previousProductPreviewImageDeletePending")),pending:o.generalPending,"previous-product-preview-image-url":d.previousProductPreviewImageUrl},null,8,["product-preview-image","pending","previous-product-preview-image-url"]),r(s,{product:d.product,"onUpdate:product":t[3]||(t[3]=c=>d.product=c)},null,8,["product"]),D("div",Q,[r(f,{pending:o.generalPending,onClick:t[4]||(t[4]=c=>o.onSubmit())},{default:i(()=>[I(U(e.$t("general.save")),1)]),_:1},8,["pending"]),(v=a.productToUpdate)!=null&&v.slug?(m(),b(P,{key:0,onDeleteProduct:t[5]||(t[5]=c=>e.$emit("deleteProduct")),slug:(V=a.productToUpdate)==null?void 0:V.slug},null,8,["slug"])):q("",!0)])]}),_:1},8,["rules","model"])}const re=g(K,[["render",X],["__scopeId","data-v-41cb7d7e"]]);export{re as P};
