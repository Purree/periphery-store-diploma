import{a7 as B,_ as M,o,c as v,w as a,d as y,e as i,a4 as f,t as m,a as n,a8 as w,a9 as A,r as d,aa as D,ab as E,u as S,a6 as I,a0 as P,B as O,ac as U,g as F,ad as R,F as h,b as k,ae as T}from"./app-a44995be.js";import{p as q,a as L}from"./price-0faa232d.js";import{P as G}from"./ProductCard-e8641878.js";import{V as W}from"./ViewTitle-c8a84335.js";import{A as j}from"./orders-e86e9fe6.js";import"./el-form-item-4ed993c7.js";import"./el-tag-93898b7a.js";import{E as z}from"./el-select-v2-a905b73b.js";import"./el-popper-c3f23f9e.js";import{S as H}from"./StyledRouterLink-17b363a0.js";import{g as J}from"./name-4e882a16.js";import"./ProductPrice-83dfc561.js";import"./el-input-number-3e92875f.js";import"./ProductOpenLink-5db88c1a.js";import"./ItemImage-7e28fc3d.js";import"./validator-ae9f5db2.js";import"./strings-d8cf358b.js";import"./isEqual-e6c06f96.js";import"./debounce-573356e3.js";const K={name:"SubmitCartMessage",components:{StyledRouterLink:H},emits:["update:isVisible","submitCart"],data(){return{userName:null,userAddress:null,userMobile:null}},props:{isVisible:{required:!0,type:Boolean},pending:{required:!0,type:Boolean}},computed:{...B("auth",["user"]),isDialogVisible:{get(){return this.isVisible},set(e){this.$emit("update:isVisible",e)}},userNames(){return this.user.names},userNameOptions(){return this.userNames.map(e=>({value:e.id,label:J(e.firstName,e.middleName,e.lastName)}))},userMobiles(){return this.user.mobiles},userMobileOptions(){return this.userMobiles.map(e=>({value:e.id,label:e.mobile}))},userAddresses(){return this.user.addresses},userAddressOptions(){return this.userAddresses.map(e=>({value:e.id,label:e.address}))}}},Q={key:1},X={class:"dialog-footer"};function Y(e,t,p,N,s,r){const c=z,_=w,b=A,C=d("styled-router-link"),g=D,V=E;return o(),v(V,{modelValue:r.isDialogVisible,"onUpdate:modelValue":t[5]||(t[5]=l=>r.isDialogVisible=l),title:e.$t("cart.cart"),width:"90%"},{footer:a(()=>[y("span",X,[i(g,{onClick:t[3]||(t[3]=l=>r.isDialogVisible=!1)},{default:a(()=>[f(m(e.$t("general.cancel")),1)]),_:1}),i(g,{type:"primary",loading:p.pending,disabled:p.pending||!(s.userName&&s.userAddress&&s.userMobile),onClick:t[4]||(t[4]=l=>e.$emit("submitCart",{userNameId:s.userName,userAddressId:s.userAddress,userMobileId:s.userMobile}))},{default:a(()=>[f(m(e.$t("general.save")),1)]),_:1},8,["loading","disabled"])])]),default:a(()=>[y("div",null,m(e.$t("cart.buyMessage.info")),1),r.userNames.length>0&&r.userAddresses.length>0&&r.userMobiles.length>0?(o(),v(b,{key:0,"label-position":"top"},{default:a(()=>[i(_,{label:e.$t("profile.titles.names")},{default:a(()=>[i(c,{modelValue:s.userName,"onUpdate:modelValue":t[0]||(t[0]=l=>s.userName=l),options:r.userNameOptions,class:"user-data-select"},null,8,["modelValue","options"])]),_:1},8,["label"]),i(_,{label:e.$t("profile.titles.mobiles")},{default:a(()=>[i(c,{modelValue:s.userMobile,"onUpdate:modelValue":t[1]||(t[1]=l=>s.userMobile=l),options:r.userMobileOptions,class:"user-data-select"},null,8,["modelValue","options"])]),_:1},8,["label"]),i(_,{label:e.$t("profile.titles.addresses")},{default:a(()=>[i(c,{modelValue:s.userAddress,"onUpdate:modelValue":t[2]||(t[2]=l=>s.userAddress=l),options:r.userAddressOptions,class:"user-data-select"},null,8,["modelValue","options"])]),_:1},8,["label"])]),_:1})):(o(),n("div",Q,[i(C,{class:"open-profile-link",to:{name:"Profile"}},{default:a(()=>[f(m(this.$t("cart.buyMessage.emptyUserData")),1)]),_:1})]))]),_:1},8,["modelValue","title"])}const Z=M(K,[["render",Y],["__scopeId","data-v-d44218f5"]]);const $={name:"Cart",mixins:[q,S,I],components:{SubmitCartMessage:Z,ViewTitle:W,FullWidthButton:P,BasedText:O,ProductCard:G},data(){return{pending:!0,isBuyCartDialogVisible:!1}},methods:{...U("cart",["loadCart"]),onBuyButtonClick(){this.isBuyCartDialogVisible=!0},async onCartSubmit({userNameId:e,userMobileId:t,userAddressId:p}){await this.useErrorsCatch(async()=>{this.isBuyCartDialogVisible=!1,await F(j,{},{userNameId:e,userMobileId:t,userAddressId:p}),await this.loadCart(),await this.$router.push({name:"Orders"})})}},computed:{...B("cart",["cartItems"]),...R("cart",["getTotalPrice"]),products(){return this.cartItems.map(e=>e.product)}},async mounted(){await this.loadCart(),this.pending=!1}},x={class:"cart-container"},ee={key:0},te={key:0},se={key:1},ie={key:1};function re(e,t,p,N,s,r){const c=d("view-title"),_=d("product-card"),b=T,C=d("based-text"),g=d("full-width-button"),V=d("submit-cart-message"),l=L;return o(),n("div",null,[i(c,{text:e.$t("cart.cart")},null,8,["text"]),y("div",x,[!s.pending||e.cartItems.length>0?(o(),n("div",ee,[e.cartItems.length>0?(o(),n("div",te,[(o(!0),n(h,null,k(r.products,u=>(o(),n("div",{key:u.slug},[i(_,{product:u,class:"product-card","is-show-add-to-cart-button":!0},null,8,["product"]),i(b)]))),128)),i(C,{title:e.$t("general.total")+": "+e.getCurrency(e.getTotalPrice)},null,8,["title"]),i(g,{type:"success",onClick:r.onBuyButtonClick,pending:s.pending},{default:a(()=>[f(m(e.$t("general.buy")),1)]),_:1},8,["onClick","pending"]),i(V,{"is-visible":s.isBuyCartDialogVisible,"onUpdate:isVisible":t[0]||(t[0]=u=>s.isBuyCartDialogVisible=u),pending:s.pending,onSubmitCart:t[1]||(t[1]=u=>e.usePending(r.onCartSubmit,"pending",u))},null,8,["is-visible","pending"])])):(o(),n("div",se,m(e.$t("cart.noProducts")),1))])):(o(),n("div",ie,[(o(),n(h,null,k(10,u=>y("div",{key:u},[i(l,{animated:""}),i(b)])),64))]))])])}const Be=M($,[["render",re],["__scopeId","data-v-4134ea5a"]]);export{Be as default};
