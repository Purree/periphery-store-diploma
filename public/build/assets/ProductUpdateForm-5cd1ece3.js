import{_ as F,q as B,B as k,i as R,T as C,k as j,g as O,m as N,o as m,c as b,w as i,e as o,p as c,t as f,a as L,d as g,f as w,r as u}from"./app-fd2cb743.js";import{I as S}from"./ItemImage-276b9ddc.js";import{P as z}from"./ProductDeleteButton-c932fc89.js";import{k as W}from"./products-71363a85.js";const M={name:"ProductUpdateForm",computed:{generalPending(){return this.pending||this.previousProductPreviewImageDeletePending}},mixins:[B],components:{ProductDeleteButton:z,BasedText:k,ItemImage:S,FontAwesomeIcon:R,ErrorsAlert:C,FullWidthButton:j},emits:["updateProduct","deleteProduct"],data(){return{product:{title:"",metaTitle:"",description:"",previewImage:[],price:-1,discount:0,quantity:0,isAvailable:!1},previousProductPreviewImageUrl:"",previousProductPreviewImageDeletePending:!1,validationRules:{title:{required:!0},metaTitle:{required:!0},description:{required:!0},price:{type:"number"},discount:{type:"number"},quantity:{type:"number"},isAvailable:{required:!0}},errors:{}}},props:{pending:{required:!1,type:Boolean,default:!1},requestErrors:{required:!1,type:Object,default:()=>{}},productToUpdate:{required:!1,type:Object,default:()=>{}}},methods:{async onSubmit(){this.errors={},await this.$refs.form.validate((e,t)=>{e?this.onFormValidation():this.errors={...this.errors,validation:[this.$t("profile.mainInformation.errors.validationMessage")]}})},async onPreviousProductPreviewDelete(){try{await O(W,{slug:this.productToUpdate.slug}),this.previousProductPreviewImageUrl=""}catch(e){this.errors=N(e)}},onFormValidation(){const e=Object.assign({},this.product);e.previewImage=e.previewImage.length===1?e.previewImage[0].raw:null,e.isAvailable=e.isAvailable?"1":"0";const t=new FormData;Object.keys(e).forEach(n=>{e[n]!==null&&t.append(n,e[n])}),this.$emit("updateProduct",t)}},watch:{productToUpdate(){const e=this.productToUpdate;this.previousProductPreviewImageUrl=e.previewImage,delete e.previewImage,this.product={...this.product,...e}}}},G={key:0},H={class:"previous-product-preview-container"},J={class:"previous-product-preview"},K={class:"product-manipulate-buttons"};function Q(e,t,n,X,r,s){const I=u("errors-alert"),d=u("el-input"),a=u("el-form-item"),v=u("font-awesome-icon"),V=u("el-popover"),U=u("el-upload"),y=u("based-text"),q=u("el-button"),T=u("item-image"),p=u("el-input-number"),h=u("el-switch"),D=u("full-width-button"),A=u("product-delete-button"),E=u("el-form");return m(),b(E,{"label-position":"top",rules:r.validationRules,ref:"form",model:r.product},{default:i(()=>{var P,_;return[o(I,{errors:{...n.requestErrors,...r.errors}},null,8,["errors"]),o(a,{label:e.$t("product.updateProduct.title"),prop:"title",class:"form-item"},{default:i(()=>[o(d,{class:"form-item-input",modelValue:r.product.title,"onUpdate:modelValue":t[0]||(t[0]=l=>r.product.title=l)},null,8,["modelValue"])]),_:1},8,["label"]),o(a,{label:e.$t("product.updateProduct.metaTitle"),prop:"metaTitle",class:"form-item"},{default:i(()=>[o(d,{class:"form-item-input",modelValue:r.product.metaTitle,"onUpdate:modelValue":t[1]||(t[1]=l=>r.product.metaTitle=l)},null,8,["modelValue"])]),_:1},8,["label"]),o(a,{label:e.$t("product.updateProduct.description"),prop:"description",class:"form-item"},{default:i(()=>[o(d,{class:"form-item-input",modelValue:r.product.description,"onUpdate:modelValue":t[2]||(t[2]=l=>r.product.description=l),autosize:{minRows:3},type:"textarea"},null,8,["modelValue"])]),_:1},8,["label"]),o(a,{prop:"previewImage",class:"form-item"},{label:i(()=>[c(f(e.$t("product.updateProduct.images.previewImage"))+" ",1),o(V,{placement:"top-start",title:e.$t("general.attention"),trigger:"hover",content:e.$tc("product.updateProduct.images.previewImageInfo",512)},{reference:i(()=>[o(v,{class:"preview-image-info-popover-icon",icon:"circle-info"})]),_:1},8,["title","content"])]),default:i(()=>[o(U,{class:"form-item-input",drag:!0,limit:1,"file-list":r.product.previewImage,"onUpdate:fileList":t[3]||(t[3]=l=>r.product.previewImage=l),"list-type":"picture",accept:"image/png, image/gif, image/jpeg","auto-upload":!1},null,8,["file-list"]),r.previousProductPreviewImageUrl?(m(),L("div",G,[o(y,{title:e.$t("product.updateProduct.images.currentImage")},null,8,["title"]),g("div",H,[o(q,{disabled:s.generalPending,loading:s.generalPending,type:"danger",plain:"",class:"delete-previous-product-preview-button",onClick:t[4]||(t[4]=l=>e.usePending(s.onPreviousProductPreviewDelete,"previousProductPreviewImageDeletePending"))},{default:i(()=>[o(v,{type:"danger",icon:"trash"},{default:i(()=>[c(f(e.$t("profile.avatar.buttons.delete")),1)]),_:1})]),_:1},8,["disabled","loading"]),g("div",J,[o(T,{"image-url":r.previousProductPreviewImageUrl},null,8,["image-url"])])])])):w("",!0)]),_:1}),o(a,{label:e.$t("product.updateProduct.price"),prop:"price",class:"form-item"},{default:i(()=>[o(p,{class:"form-item-input",modelValue:r.product.price,"onUpdate:modelValue":t[5]||(t[5]=l=>r.product.price=l)},null,8,["modelValue"])]),_:1},8,["label"]),o(a,{label:e.$t("product.updateProduct.discount"),prop:"discount",class:"form-item"},{default:i(()=>[o(p,{min:0,max:100,class:"form-item-input",modelValue:r.product.discount,"onUpdate:modelValue":t[6]||(t[6]=l=>r.product.discount=l)},null,8,["modelValue"])]),_:1},8,["label"]),o(a,{label:e.$t("product.updateProduct.quantity"),prop:"quantity",class:"form-item"},{default:i(()=>[o(p,{class:"form-item-input",min:0,modelValue:r.product.quantity,"onUpdate:modelValue":t[7]||(t[7]=l=>r.product.quantity=l)},null,8,["modelValue"])]),_:1},8,["label"]),o(a,{label:e.$t("product.updateProduct.isAvailable"),prop:"isAvailable",class:"form-item"},{default:i(()=>[o(h,{class:"form-item-input","active-text":e.$t("product.updateProduct.available"),"inactive-text":e.$t("product.updateProduct.unavailable"),modelValue:r.product.isAvailable,"onUpdate:modelValue":t[8]||(t[8]=l=>r.product.isAvailable=l),size:"large"},null,8,["active-text","inactive-text","modelValue"])]),_:1},8,["label"]),g("div",K,[o(D,{pending:s.generalPending,onClick:t[9]||(t[9]=l=>s.onSubmit())},{default:i(()=>[c(f(e.$t("general.save")),1)]),_:1},8,["pending"]),(P=n.productToUpdate)!=null&&P.slug?(m(),b(A,{key:0,onDeleteProduct:t[10]||(t[10]=l=>e.$emit("deleteProduct")),slug:(_=n.productToUpdate)==null?void 0:_.slug},null,8,["slug"])):w("",!0)])]}),_:1},8,["rules","model"])}const ee=F(M,[["render",Q],["__scopeId","data-v-cc46df80"]]);export{ee as P};
