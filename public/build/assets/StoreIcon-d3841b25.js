import{b9 as V,k as fe,l as oe,af as ve,p as ce,N as Q,b0 as ue,ba as ke,bb as _e,W as me,O as pe,bc as Ie,v as b,bd as ze,G as Le,D as y,J as le,z as ge,x as we,o as m,c as re,e as u,w as _,d as g,n as d,R as t,j as ie,aG as Ce,f as z,al as T,ao as Ee,a as I,F as q,am as Se,an as $e,be as Oe,bf as Te,bg as Ne,bh as xe,bi as Re,b as Ae,av as Be,aw as Ve,h as K,aI as Me,bj as Pe,S as be,K as B,y as M,bk as De,$ as ye,bl as Ye,bm as Fe,t as Xe,aJ as he,bn as He,T as je,aC as We,aF as Ge,_ as Ze}from"./app-a44995be.js";import{t as ne}from"./throttle-7ddc0281.js";const Je=(s,i)=>{if(!V||!s||!i)return!1;const o=s.getBoundingClientRect();let l;return i instanceof Element?l=i.getBoundingClientRect():l={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},o.top<l.bottom&&o.bottom>l.top&&o.right>l.left&&o.left<l.right},de=s=>{let i=0,o=s;for(;o;)i+=o.offsetTop,o=o.offsetParent;return i},wt=(s,i)=>Math.abs(de(s)-de(i)),Ke=fe({urlList:{type:oe(Array),default:()=>ve([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),qe={close:()=>!0,switch:s=>ce(s)},Qe=["src"],Ue=Q({name:"ElImageViewer"}),et=Q({...Ue,props:Ke,emits:qe,setup(s,{expose:i,emit:o}){const l=s,$={CONTAIN:{name:"contain",icon:ue(ke)},ORIGINAL:{name:"original",icon:ue(_e)}},{t:h}=me(),r=pe("image-viewer"),{nextZIndex:U}=Ie(),N=b(),O=b([]),L=ze(),k=b(!0),f=b(l.initialIndex),v=Le($.CONTAIN),c=b({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),P=y(()=>{const{urlList:e}=l;return e.length<=1}),x=y(()=>f.value===0),j=y(()=>f.value===l.urlList.length-1),ee=y(()=>l.urlList[f.value]),D=y(()=>{const{scale:e,deg:a,offsetX:n,offsetY:p,enableTransition:E}=c.value;let w=n/e,S=p/e;switch(a%360){case 90:case-270:[w,S]=[S,-w];break;case 180:case-180:[w,S]=[-w,-S];break;case 270:case-90:[w,S]=[-S,w];break}const A={transform:`scale(${e}) rotate(${a}deg) translate(${w}px, ${S}px)`,transition:E?"transform .3s":""};return v.value.name===$.CONTAIN.name&&(A.maxWidth=A.maxHeight="100%"),A}),te=y(()=>ce(l.zIndex)?l.zIndex:U());function R(){ae(),o("close")}function Y(){const e=ne(n=>{switch(n.code){case B.esc:l.closeOnPressEscape&&R();break;case B.space:X();break;case B.left:Z();break;case B.up:C("zoomIn");break;case B.right:J();break;case B.down:C("zoomOut");break}}),a=ne(n=>{const p=n.deltaY||n.deltaX;C(p<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})});L.run(()=>{M(document,"keydown",e),M(document,"wheel",a)})}function ae(){L.stop()}function se(){k.value=!1}function W(e){k.value=!1,e.target.alt=h("el.image.error")}function G(e){if(k.value||e.button!==0||!N.value)return;c.value.enableTransition=!1;const{offsetX:a,offsetY:n}=c.value,p=e.pageX,E=e.pageY,w=ne(A=>{c.value={...c.value,offsetX:a+A.pageX-p,offsetY:n+A.pageY-E}}),S=M(document,"mousemove",w);M(document,"mouseup",()=>{S()}),e.preventDefault()}function F(){c.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function X(){if(k.value)return;const e=De($),a=Object.values($),n=v.value.name,E=(a.findIndex(w=>w.name===n)+1)%e.length;v.value=$[e[E]],F()}function H(e){const a=l.urlList.length;f.value=(e+a)%a}function Z(){x.value&&!l.infinite||H(f.value-1)}function J(){j.value&&!l.infinite||H(f.value+1)}function C(e,a={}){if(k.value)return;const{zoomRate:n,rotateDeg:p,enableTransition:E}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...a};switch(e){case"zoomOut":c.value.scale>.2&&(c.value.scale=Number.parseFloat((c.value.scale/n).toFixed(3)));break;case"zoomIn":c.value.scale<7&&(c.value.scale=Number.parseFloat((c.value.scale*n).toFixed(3)));break;case"clockwise":c.value.deg+=p;break;case"anticlockwise":c.value.deg-=p;break}c.value.enableTransition=E}return le(ee,()=>{ge(()=>{const e=O.value[0];e!=null&&e.complete||(k.value=!0)})}),le(f,e=>{F(),o("switch",e)}),we(()=>{var e,a;Y(),(a=(e=N.value)==null?void 0:e.focus)==null||a.call(e)}),i({setActiveItem:H}),(e,a)=>(m(),re(Pe,{to:"body",disabled:!e.teleported},[u(Me,{name:"viewer-fade",appear:""},{default:_(()=>[g("div",{ref_key:"wrapper",ref:N,tabindex:-1,class:d(t(r).e("wrapper")),style:ie({zIndex:t(te)})},[g("div",{class:d(t(r).e("mask")),onClick:a[0]||(a[0]=Ce(n=>e.hideOnClickModal&&R(),["self"]))},null,2),z(" CLOSE "),g("span",{class:d([t(r).e("btn"),t(r).e("close")]),onClick:R},[u(t(T),null,{default:_(()=>[u(t(Ee))]),_:1})],2),z(" ARROW "),t(P)?z("v-if",!0):(m(),I(q,{key:0},[g("span",{class:d([t(r).e("btn"),t(r).e("prev"),t(r).is("disabled",!e.infinite&&t(x))]),onClick:Z},[u(t(T),null,{default:_(()=>[u(t(Se))]),_:1})],2),g("span",{class:d([t(r).e("btn"),t(r).e("next"),t(r).is("disabled",!e.infinite&&t(j))]),onClick:J},[u(t(T),null,{default:_(()=>[u(t($e))]),_:1})],2)],64)),z(" ACTIONS "),g("div",{class:d([t(r).e("btn"),t(r).e("actions")])},[g("div",{class:d(t(r).e("actions__inner"))},[u(t(T),{onClick:a[1]||(a[1]=n=>C("zoomOut"))},{default:_(()=>[u(t(Oe))]),_:1}),u(t(T),{onClick:a[2]||(a[2]=n=>C("zoomIn"))},{default:_(()=>[u(t(Te))]),_:1}),g("i",{class:d(t(r).e("actions__divider"))},null,2),u(t(T),{onClick:X},{default:_(()=>[(m(),re(Ne(t(v).icon)))]),_:1}),g("i",{class:d(t(r).e("actions__divider"))},null,2),u(t(T),{onClick:a[3]||(a[3]=n=>C("anticlockwise"))},{default:_(()=>[u(t(xe))]),_:1}),u(t(T),{onClick:a[4]||(a[4]=n=>C("clockwise"))},{default:_(()=>[u(t(Re))]),_:1})],2)],2),z(" CANVAS "),g("div",{class:d(t(r).e("canvas"))},[(m(!0),I(q,null,Ae(e.urlList,(n,p)=>Be((m(),I("img",{ref_for:!0,ref:E=>O.value[p]=E,key:n,src:n,style:ie(t(D)),class:d(t(r).e("img")),onLoad:se,onError:W,onMousedown:G},null,46,Qe)),[[Ve,p===f.value]])),128))],2),K(e.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var tt=be(et,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const at=ye(tt),st=fe({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:oe([String,Object])},previewSrcList:{type:oe(Array),default:()=>ve([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),nt={load:s=>s instanceof Event,error:s=>s instanceof Event,switch:s=>ce(s),close:()=>!0,show:()=>!0},ot=["src","loading"],lt={key:0},rt=Q({name:"ElImage",inheritAttrs:!1}),it=Q({...rt,props:st,emits:nt,setup(s,{emit:i}){const o=s;let l="";const{t:$}=me(),h=pe("image"),r=Ye(),U=Fe(),N=b(),O=b(!1),L=b(!0),k=b(!1),f=b(),v=b(),c=V&&"loading"in HTMLImageElement.prototype;let P,x;const j=y(()=>r.style),ee=y(()=>{const{fit:e}=o;return V&&e?{objectFit:e}:{}}),D=y(()=>{const{previewSrcList:e}=o;return Array.isArray(e)&&e.length>0}),te=y(()=>{const{previewSrcList:e,initialIndex:a}=o;let n=a;return a>e.length-1&&(n=0),n}),R=y(()=>o.loading==="eager"?!1:!c&&o.loading==="lazy"||o.lazy),Y=()=>{V&&(L.value=!0,O.value=!1,N.value=o.src)};function ae(e){L.value=!1,O.value=!1,i("load",e)}function se(e){L.value=!1,O.value=!0,i("error",e)}function W(){Je(f.value,v.value)&&(Y(),X())}const G=Ge(W,200);async function F(){var e;if(!V)return;await ge();const{scrollContainer:a}=o;He(a)?v.value=a:je(a)&&a!==""?v.value=(e=document.querySelector(a))!=null?e:void 0:f.value&&(v.value=We(f.value)),v.value&&(P=M(v,"scroll",G),setTimeout(()=>W(),100))}function X(){!V||!v.value||!G||(P==null||P(),v.value=void 0)}function H(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function Z(){D.value&&(x=M("wheel",H,{passive:!1}),l=document.body.style.overflow,document.body.style.overflow="hidden",k.value=!0,i("show"))}function J(){x==null||x(),document.body.style.overflow=l,k.value=!1,i("close")}function C(e){i("switch",e)}return le(()=>o.src,()=>{R.value?(L.value=!0,O.value=!1,X(),F()):Y()}),we(()=>{R.value?F():Y()}),(e,a)=>(m(),I("div",{ref_key:"container",ref:f,class:d([t(h).b(),e.$attrs.class]),style:ie(t(j))},[O.value?K(e.$slots,"error",{key:0},()=>[g("div",{class:d(t(h).e("error"))},Xe(t($)("el.image.error")),3)]):(m(),I(q,{key:1},[N.value!==void 0?(m(),I("img",he({key:0},t(U),{src:N.value,loading:e.loading,style:t(ee),class:[t(h).e("inner"),t(D)&&t(h).e("preview"),L.value&&t(h).is("loading")],onClick:Z,onLoad:ae,onError:se}),null,16,ot)):z("v-if",!0),L.value?(m(),I("div",{key:1,class:d(t(h).e("wrapper"))},[K(e.$slots,"placeholder",{},()=>[g("div",{class:d(t(h).e("placeholder"))},null,2)])],2)):z("v-if",!0)],64)),t(D)?(m(),I(q,{key:2},[k.value?(m(),re(t(at),{key:0,"z-index":e.zIndex,"initial-index":t(te),infinite:e.infinite,"zoom-rate":e.zoomRate,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:J,onSwitch:C},{default:_(()=>[e.$slots.viewer?(m(),I("div",lt,[K(e.$slots,"viewer")])):z("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):z("v-if",!0)],64)):z("v-if",!0)],6))}});var ct=be(it,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const ut=ye(ct);const dt={methods:{asset(s){return(window._asset||"")+s},stored_asset(s){return(window._asset||"")+"storage/"+s}}},ft={name:"StoreIcon",mixins:[dt]},vt={class:"store-icon"};function mt(s,i,o,l,$,h){const r=ut;return m(),I("div",vt,[u(r,he(s.$attrs,{src:s.stored_asset("logo.png"),fit:"cover"}),null,16,["src"])])}const bt=Ze(ft,[["render",mt]]);export{bt as S,wt as g};
