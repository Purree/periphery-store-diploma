import{S as R,N as V,h as C,v as q,Z as L,H as z,x as H,R as _,aQ as K,k as N,l as y,aR as J,ay as W,D as E,O as Y,aB as G,o as w,c as D,w as c,a as O,n as Q,t as U,f as $,a4 as T,aJ as Z,co as X,$ as x,_ as S,B as ee,r as P,e as n,d as A,aa as te,a8 as F,F as M,a5 as oe,a6 as re,bq as ae,a0 as ne,g as le,a2 as ie,a9 as pe}from"./app-a44995be.js";import{E as se,P as ue}from"./ProductDeleteButton-46b39347.js";import{k as de}from"./products-642553d7.js";import"./el-form-item-4ed993c7.js";import{b as k,u as g,a as ce}from"./el-popper-c3f23f9e.js";import{I as me}from"./ItemImage-7e28fc3d.js";import{E as fe}from"./el-switch-b953123d.js";import{E as ve}from"./el-input-number-3e92875f.js";const ge=V({inheritAttrs:!1});function _e(e,t,a,i,l,o){return C(e.$slots,"default")}var be=R(ge,[["render",_e],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection.vue"]]);const Pe=V({name:"ElCollectionItem",inheritAttrs:!1});function we(e,t,a,i,l,o){return C(e.$slots,"default")}var ye=R(Pe,[["render",we],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection-item.vue"]]);const Ie="data-el-collection-item",he=e=>{const t=`El${e}Collection`,a=`${t}Item`,i=Symbol(t),l=Symbol(a),o={...be,name:t,setup(){const s=q(null),u=new Map;L(i,{itemMap:u,getItems:()=>{const f=_(s);if(!f)return[];const m=Array.from(f.querySelectorAll(`[${Ie}]`));return[...u.values()].sort((b,h)=>m.indexOf(b.ref)-m.indexOf(h.ref))},collectionRef:s})}},p={...ye,name:a,setup(s,{attrs:u}){const d=q(null),f=z(i,void 0);L(l,{collectionItemRef:d}),H(()=>{const m=_(d);m&&f.itemMap.set(m,{ref:m,...u})}),K(()=>{const m=_(d);f.itemMap.delete(m)})}};return{COLLECTION_INJECTION_KEY:i,COLLECTION_ITEM_INJECTION_KEY:l,ElCollection:o,ElCollectionItem:p}},B=N({trigger:k.trigger,effect:{...g.effect,default:"light"},type:{type:y(String)},placement:{type:y(String),default:"bottom"},popperOptions:{type:y(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:y([Number,String]),default:0},maxHeight:{type:y([Number,String]),default:""},popperClass:{type:String,default:""},disabled:{type:Boolean,default:!1},role:{type:String,default:"menu"},buttonProps:{type:y(Object)},teleported:g.teleported});N({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:J}});N({onKeydown:{type:y(Function)}});he("Dropdown");const Ee=N({trigger:k.trigger,placement:B.placement,disabled:k.disabled,visible:g.visible,transition:g.transition,popperOptions:B.popperOptions,tabindex:B.tabindex,content:g.content,popperStyle:g.popperStyle,popperClass:g.popperClass,enterable:{...g.enterable,default:!0},effect:{...g.effect,default:"light"},teleported:g.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),Ue={"update:visible":e=>W(e),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},Ce="onUpdate:visible",De=V({name:"ElPopover"}),$e=V({...De,props:Ee,emits:Ue,setup(e,{expose:t,emit:a}){const i=e,l=E(()=>i[Ce]),o=Y("popover"),p=q(),s=E(()=>{var r;return(r=_(p))==null?void 0:r.popperRef}),u=E(()=>[{width:G(i.width)},i.popperStyle]),d=E(()=>[o.b(),i.popperClass,{[o.m("plain")]:!!i.content}]),f=E(()=>i.transition===`${o.namespace.value}-fade-in-linear`),m=()=>{var r;(r=p.value)==null||r.hide()},I=()=>{a("before-enter")},b=()=>{a("before-leave")},h=()=>{a("after-enter")},v=()=>{a("update:visible",!1),a("after-leave")};return t({popperRef:s,hide:m}),(r,Ge)=>(w(),D(_(ce),Z({ref_key:"tooltipRef",ref:p},r.$attrs,{trigger:r.trigger,placement:r.placement,disabled:r.disabled,visible:r.visible,transition:r.transition,"popper-options":r.popperOptions,tabindex:r.tabindex,content:r.content,offset:r.offset,"show-after":r.showAfter,"hide-after":r.hideAfter,"auto-close":r.autoClose,"show-arrow":r.showArrow,"aria-label":r.title,effect:r.effect,enterable:r.enterable,"popper-class":_(d),"popper-style":_(u),teleported:r.teleported,persistent:r.persistent,"gpu-acceleration":_(f),"onUpdate:visible":_(l),onBeforeShow:I,onBeforeHide:b,onShow:h,onHide:v}),{content:c(()=>[r.title?(w(),O("div",{key:0,class:Q(_(o).e("title")),role:"title"},U(r.title),3)):$("v-if",!0),C(r.$slots,"default",{},()=>[T(U(r.content),1)])]),default:c(()=>[r.$slots.reference?C(r.$slots,"reference",{key:0}):$("v-if",!0)]),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var Te=R($e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popover/src/popover.vue"]]);const j=(e,t)=>{const a=t.arg||t.value,i=a==null?void 0:a.popperRef;i&&(i.triggerRef=e)};var Ve={mounted(e,t){j(e,t)},updated(e,t){j(e,t)}};const Ne="popover",Oe=X(Ve,Ne),Se=x(Te,{directive:Oe});const Be={name:"ProductUpdatePreviewForm",emits:["update:productPreviewImage","deletePreviousProductPreview"],components:{BasedText:ee,ItemImage:me},props:{previousProductPreviewImageUrl:{required:!0,type:String},pending:{required:!0,type:Boolean},productPreviewImage:{required:!0}},computed:{previewImage:{get(){return this.productPreviewImage},set(e){this.$emit("update:productPreviewImage",e)}}}},qe={key:0},Ae={class:"previous-product-preview-container"},ke={class:"previous-product-preview"};function Re(e,t,a,i,l,o){const p=P("font-awesome-icon"),s=Se,u=se,d=P("based-text"),f=te,m=P("item-image"),I=F;return w(),D(I,{prop:"previewImage",class:"form-item"},{label:c(()=>[T(U(e.$t("product.updateProduct.images.previewImage"))+" ",1),n(s,{placement:"top-start",title:e.$t("general.attention"),trigger:"hover",content:e.$tc("product.updateProduct.images.previewImageInfo",512)},{reference:c(()=>[n(p,{class:"preview-image-info-popover-icon",icon:"circle-info"})]),_:1},8,["title","content"])]),default:c(()=>[n(u,{class:"form-item-input",drag:!0,limit:1,"file-list":o.previewImage,"onUpdate:fileList":t[0]||(t[0]=b=>o.previewImage=b),"list-type":"picture",accept:"image/png, image/gif, image/jpeg","auto-upload":!1},null,8,["file-list"]),a.previousProductPreviewImageUrl?(w(),O("div",qe,[n(d,{title:e.$t("product.updateProduct.images.currentImage")},null,8,["title"]),A("div",Ae,[n(f,{disabled:a.pending,loading:a.pending,type:"danger",plain:"",class:"delete-previous-product-preview-button",onClick:t[1]||(t[1]=b=>e.$emit("deletePreviousProductPreview"))},{default:c(()=>[n(p,{type:"danger",icon:"trash"},{default:c(()=>[T(U(e.$t("profile.avatar.buttons.delete")),1)]),_:1})]),_:1},8,["disabled","loading"]),A("div",ke,[n(m,{"image-url":a.previousProductPreviewImageUrl},null,8,["image-url"])])])])):$("",!0)]),_:1})}const Fe=S(Be,[["render",Re],["__scopeId","data-v-e90ec75d"]]),Le={name:"ProductUpdateTextDataInputs",emits:["update:product"],props:{product:{required:!0,type:Object}},computed:{productData:{get(){return this.product},set(e){this.$emit("update:product",e)}}}};function je(e,t,a,i,l,o){const p=oe,s=F;return w(),O(M,null,[n(s,{label:e.$t("product.updateProduct.title"),prop:"title",class:"form-item"},{default:c(()=>[n(p,{class:"form-item-input",modelValue:o.productData.title,"onUpdate:modelValue":t[0]||(t[0]=u=>o.productData.title=u)},null,8,["modelValue"])]),_:1},8,["label"]),n(s,{label:e.$t("product.updateProduct.metaTitle"),prop:"metaTitle",class:"form-item"},{default:c(()=>[n(p,{class:"form-item-input",modelValue:o.productData.metaTitle,"onUpdate:modelValue":t[1]||(t[1]=u=>o.productData.metaTitle=u)},null,8,["modelValue"])]),_:1},8,["label"]),n(s,{label:e.$t("product.updateProduct.description"),prop:"description",class:"form-item"},{default:c(()=>[n(p,{class:"form-item-input",modelValue:o.productData.description,"onUpdate:modelValue":t[2]||(t[2]=u=>o.productData.description=u),autosize:{minRows:3},type:"textarea"},null,8,["modelValue"])]),_:1},8,["label"])],64)}const Me=S(Le,[["render",je]]),ze={name:"ProductUpdateComplexDataInputs",emits:["update:product"],props:{product:{required:!0,type:Object}},computed:{productData:{get(){return this.product},set(e){this.$emit("update:product",e)}}}};function He(e,t,a,i,l,o){const p=ve,s=F,u=fe;return w(),O(M,null,[n(s,{label:e.$t("product.updateProduct.price"),prop:"price",class:"form-item"},{default:c(()=>[n(p,{class:"form-item-input",modelValue:o.productData.price,"onUpdate:modelValue":t[0]||(t[0]=d=>o.productData.price=d)},null,8,["modelValue"])]),_:1},8,["label"]),n(s,{label:e.$t("product.updateProduct.discount"),prop:"discount",class:"form-item"},{default:c(()=>[n(p,{min:0,max:100,class:"form-item-input",modelValue:o.productData.discount,"onUpdate:modelValue":t[1]||(t[1]=d=>o.productData.discount=d)},null,8,["modelValue"])]),_:1},8,["label"]),n(s,{label:e.$t("product.updateProduct.quantity"),prop:"quantity",class:"form-item"},{default:c(()=>[n(p,{class:"form-item-input",min:0,modelValue:o.productData.quantity,"onUpdate:modelValue":t[2]||(t[2]=d=>o.productData.quantity=d)},null,8,["modelValue"])]),_:1},8,["label"]),n(s,{label:e.$t("product.updateProduct.isAvailable"),prop:"isAvailable",class:"form-item"},{default:c(()=>[n(u,{class:"form-item-input","active-text":e.$t("product.updateProduct.available"),"inactive-text":e.$t("product.updateProduct.unavailable"),modelValue:o.productData.isAvailable,"onUpdate:modelValue":t[3]||(t[3]=d=>o.productData.isAvailable=d),size:"large"},null,8,["active-text","inactive-text","modelValue"])]),_:1},8,["label"])],64)}const Ke=S(ze,[["render",He]]);const Je={name:"ProductUpdateForm",computed:{generalPending(){return this.pending||this.previousProductPreviewImageDeletePending}},mixins:[re],components:{ProductUpdateComplexDataInputs:Ke,ProductUpdateTextDataInputs:Me,ProductUpdatePreviewForm:Fe,ProductDeleteButton:ue,ErrorsAlert:ae,FullWidthButton:ne},emits:["updateProduct","deleteProduct"],data(){return{product:{title:"",metaTitle:"",description:"",previewImage:[],price:-1,discount:0,quantity:0,isAvailable:!1},previousProductPreviewImageUrl:"",previousProductPreviewImageDeletePending:!1,validationRules:{title:{required:!0},metaTitle:{required:!0},description:{required:!0},price:{type:"number"},discount:{type:"number"},quantity:{type:"number"},isAvailable:{required:!0}},errors:{}}},props:{pending:{required:!1,type:Boolean,default:!1},requestErrors:{required:!1,type:Object,default:()=>{}},productToUpdate:{required:!1,type:Object,default:()=>{}}},methods:{async onSubmit(){this.errors={},await this.$refs.form.validate((e,t)=>{e?this.onFormValidation():this.errors={...this.errors,validation:[this.$t("profile.mainInformation.errors.validationMessage")]}})},async onPreviousProductPreviewDelete(){try{await le(de,{slug:this.productToUpdate.slug}),this.previousProductPreviewImageUrl=""}catch(e){this.errors=ie(e)}},onFormValidation(){const e=Object.assign({},this.product);e.previewImage=e.previewImage.length===1?e.previewImage[0].raw:null,e.isAvailable=e.isAvailable?"1":"0";const t=new FormData;Object.keys(e).forEach(a=>{e[a]!==null&&t.append(a,e[a])}),this.$emit("updateProduct",t)}},watch:{productToUpdate(){const e=this.productToUpdate;this.previousProductPreviewImageUrl=e.previewImage,delete e.previewImage,this.product={...this.product,...e}}}},We={class:"product-manipulate-buttons"};function Ye(e,t,a,i,l,o){const p=P("errors-alert"),s=P("product-update-text-data-inputs"),u=P("product-update-preview-form"),d=P("product-update-complex-data-inputs"),f=P("full-width-button"),m=P("product-delete-button"),I=pe;return w(),D(I,{"label-position":"top",rules:l.validationRules,ref:"form",model:l.product},{default:c(()=>{var b,h;return[n(p,{errors:{...a.requestErrors,...l.errors}},null,8,["errors"]),n(s,{product:l.product,"onUpdate:product":t[0]||(t[0]=v=>l.product=v)},null,8,["product"]),n(u,{"product-preview-image":l.product.previewImage,"onUpdate:productPreviewImage":t[1]||(t[1]=v=>l.product.previewImage=v),onDeletePreviousProductPreview:t[2]||(t[2]=v=>e.usePending(o.onPreviousProductPreviewDelete,"previousProductPreviewImageDeletePending")),pending:o.generalPending,"previous-product-preview-image-url":l.previousProductPreviewImageUrl},null,8,["product-preview-image","pending","previous-product-preview-image-url"]),n(d,{product:l.product,"onUpdate:product":t[3]||(t[3]=v=>l.product=v)},null,8,["product"]),A("div",We,[n(f,{pending:o.generalPending,onClick:t[4]||(t[4]=v=>o.onSubmit())},{default:c(()=>[T(U(e.$t("general.save")),1)]),_:1},8,["pending"]),(b=a.productToUpdate)!=null&&b.slug?(w(),D(m,{key:0,onDeleteProduct:t[5]||(t[5]=v=>e.$emit("deleteProduct")),slug:(h=a.productToUpdate)==null?void 0:h.slug},null,8,["slug"])):$("",!0)])]}),_:1},8,["rules","model"])}const at=S(Je,[["render",Ye],["__scopeId","data-v-41cb7d7e"]]);export{at as P};
